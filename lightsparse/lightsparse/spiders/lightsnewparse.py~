import scrapy


class LightsnewparseSpider(scrapy.Spider):
    name = "lightsnewparse"
    allowed_domains = ["https://svetilnik-online.ru"]
    start_urls = ["https://svetilnik-online.ru/lustri"]

    custom_settings = {
        'FEED_URI': 'lights_data.csv',
        'FEED_FORMAT': 'csv',
        'FEED_EXPORT_FIELDS': ["name", "price", "link"],
        'FEED_OVERWRITE': True,
    }

    def parse(self, response):
        lights = response.css('li.item')
        for light in lights:
            yield {
                'name': light.css('a').attrib['title'],
                'price': light.css('span.pprice::text').get(),
                'link': light.css('a').attrib['href'],
            }
